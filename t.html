<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Speak to Text Form</title>
<style>
  /* CSS styles */
</style>
</head>
<body>

<div class="container">
  <h1>Speech to Text Form</h1>
  <form id="speechForm">
    <select id="languageSelector">
      <option value="">Auto Detect</option>
      <!-- Additional options can be added here -->
    </select>
    <textarea id="textInput" placeholder="Speak something..." rows="5" cols="30"></textarea>
    <button type="button" id="startButton">Start Speech Recognition</button>
  </form>
</div>

<script>
  if ('webkitSpeechRecognition' in window) {
    var speechRecognition = new webkitSpeechRecognition();
    var finalTranscript = '';
    var isRecognizing = false; // Track if recognition is in progress

    speechRecognition.continuous = true;
    speechRecognition.interimResults = true;
    speechRecognition.lang = ''; // Empty string for auto detection

    // Populate the language dropdown with options
    var languageSelector = document.getElementById('languageSelector');
    var languages = window.speechSynthesis.getVoices(); // Get available voices
    languages.forEach(function(voice) {
      var option = document.createElement('option');
      option.value = voice.lang;
      option.textContent = voice.name + ' (' + voice.lang + ')';
      languageSelector.appendChild(option);
    });

    speechRecognition.onresult = function(event) {
      var interimTranscript = '';
      for (var i = event.resultIndex; i < event.results.length; ++i) {
        if (event.results[i].isFinal) {
          finalTranscript += event.results[i][0].transcript;
        } else {
          interimTranscript += event.results[i][0].transcript;
        }
      }
      document.getElementById('textInput').value = finalTranscript + interimTranscript;
    };

    speechRecognition.onend = function() {
      isRecognizing = false;
      document.getElementById('startButton').disabled = false; // Re-enable start button
    };

    document.getElementById('startButton').onclick = function() {
      if (!isRecognizing) {
        finalTranscript = '';
        speechRecognition.lang = languageSelector.value || ''; // Update language setting
        speechRecognition.start();
        isRecognizing = true;
        document.getElementById('startButton').disabled = true; // Disable start button while recognizing
      }
    };
  } else {
    console.log('Web Speech API is not supported in this browser.');
  }
</script>
</body>
</html>
